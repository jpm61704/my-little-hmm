<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">ForwardAlgorithm</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><a href="HMM.html"><span class="hs-identifier">HMM</span></a><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map.Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.State.Lazy</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Reader</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Identity</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-comment">-- * Likelihood (Problem 1)</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-comment">{- |
the probability of an observation sequence occurring given a model

this is problem 1, or the likelihood problem, in most HMM texts
-}</span><span>
</span><a name="line-17"></a><span class="hs-identifier">likelihood</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Traversable</span><span> </span><a href="#local-6989586621679046262"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="#local-6989586621679046262"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679046263"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679046264"><span class="hs-identifier hs-type">seq</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679046265"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HMM.html#HMM"><span class="hs-identifier hs-type">HMM</span></a><span> </span><a href="#local-6989586621679046265"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046266"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679046263"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679046262"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-19"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HMM.html#ObservationSeq"><span class="hs-identifier hs-type">ObservationSeq</span></a><span> </span><a href="#local-6989586621679046266"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679046264"><span class="hs-identifier hs-type">seq</span></a><span>
</span><a name="line-20"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046263"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-21"></a><a name="likelihood"><a href="ForwardAlgorithm.html#likelihood"><span class="hs-identifier">likelihood</span></a></a><span> </span><a name="local-6989586621679046267"><a href="#local-6989586621679046267"><span class="hs-identifier">hmm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="ForwardAlgorithm.html#alphas_T"><span class="hs-identifier hs-var">alphas_T</span></a><span> </span><a href="#local-6989586621679046267"><span class="hs-identifier hs-var">hmm</span></a><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">-- ** Calculation of the Forward Variable(Alpha)</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">type</span><span> </span><a name="Alpha"><a href="ForwardAlgorithm.html#Alpha"><span class="hs-identifier">Alpha</span></a></a><span> </span><a name="local-6989586621679046235"><a href="#local-6989586621679046235"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679046235"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">type</span><span> </span><a name="AlphaMap"><a href="ForwardAlgorithm.html#AlphaMap"><span class="hs-identifier">AlphaMap</span></a></a><span> </span><a name="local-6989586621679046233"><a href="#local-6989586621679046233"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679046234"><a href="#local-6989586621679046234"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">M.Map</span><span> </span><a href="#local-6989586621679046233"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046234"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">-- | The alpha calculation made for an entire observation sequence</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- This is summed over to achieve the probability of a sequence occurring</span><span>
</span><a name="line-33"></a><span class="hs-identifier">alphas_T</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Traversable</span><span> </span><a href="#local-6989586621679046257"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="#local-6989586621679046257"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679046258"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679046259"><span class="hs-identifier hs-type">seq</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679046260"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HMM.html#HMM"><span class="hs-identifier hs-type">HMM</span></a><span> </span><a href="#local-6989586621679046260"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046261"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679046258"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679046257"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-35"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HMM.html#ObservationSeq"><span class="hs-identifier hs-type">ObservationSeq</span></a><span> </span><a href="#local-6989586621679046261"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679046259"><span class="hs-identifier hs-type">seq</span></a><span>
</span><a name="line-36"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ForwardAlgorithm.html#AlphaMap"><span class="hs-identifier hs-type">AlphaMap</span></a><span> </span><a href="#local-6989586621679046260"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046258"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-37"></a><a name="alphas_T"><a href="ForwardAlgorithm.html#alphas_T"><span class="hs-identifier">alphas_T</span></a></a><span> </span><a name="local-6989586621679046268"><a href="#local-6989586621679046268"><span class="hs-identifier">hmm</span></a></a><span> </span><span class="hs-special">(</span><a href="HMM.html#ObsSeq"><span class="hs-identifier hs-var">ObsSeq</span></a><span> </span><a name="local-6989586621679046269"><a href="#local-6989586621679046269"><span class="hs-identifier">frst</span></a></a><span> </span><a name="local-6989586621679046270"><a href="#local-6989586621679046270"><span class="hs-identifier">rst</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><a href="#local-6989586621679046271"><span class="hs-identifier hs-var">al_t</span></a><span> </span><a href="#local-6989586621679046272"><span class="hs-identifier hs-var">al_1</span></a><span> </span><a href="#local-6989586621679046270"><span class="hs-identifier hs-var">rst</span></a><span>
</span><a name="line-38"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679046271"><a href="#local-6989586621679046271"><span class="hs-identifier">al_t</span></a></a><span> </span><a name="local-6989586621679046273"><a href="#local-6989586621679046273"><span class="hs-identifier">am</span></a></a><span> </span><a name="local-6989586621679046274"><a href="#local-6989586621679046274"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ForwardAlgorithm.html#alphas_t"><span class="hs-identifier hs-var">alphas_t</span></a><span> </span><a href="#local-6989586621679046273"><span class="hs-identifier hs-var">am</span></a><span> </span><a href="#local-6989586621679046268"><span class="hs-identifier hs-var">hmm</span></a><span> </span><a href="#local-6989586621679046274"><span class="hs-identifier hs-var">o</span></a><span>
</span><a name="line-39"></a><span>        </span><a name="local-6989586621679046272"><a href="#local-6989586621679046272"><span class="hs-identifier">al_1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ForwardAlgorithm.html#alphas_1"><span class="hs-identifier hs-var">alphas_1</span></a><span> </span><a href="#local-6989586621679046268"><span class="hs-identifier hs-var">hmm</span></a><span> </span><a href="#local-6989586621679046269"><span class="hs-identifier hs-var">frst</span></a><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">-- | the alphas for observation o_t with respect to the alphas from the</span><span>
</span><a name="line-42"></a><span class="hs-comment">-- previous observation.</span><span>
</span><a name="line-43"></a><span class="hs-identifier">alphas_t</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679046253"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679046254"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679046255"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="ForwardAlgorithm.html#AlphaMap"><span class="hs-identifier hs-type">AlphaMap</span></a><span> </span><a href="#local-6989586621679046254"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046253"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HMM.html#HMM"><span class="hs-identifier hs-type">HMM</span></a><span> </span><a href="#local-6989586621679046254"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046256"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679046253"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679046255"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046256"><span class="hs-identifier hs-type">o</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ForwardAlgorithm.html#AlphaMap"><span class="hs-identifier hs-type">AlphaMap</span></a><span> </span><a href="#local-6989586621679046254"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046253"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-45"></a><a name="alphas_t"><a href="ForwardAlgorithm.html#alphas_t"><span class="hs-identifier">alphas_t</span></a></a><span> </span><a name="local-6989586621679046275"><a href="#local-6989586621679046275"><span class="hs-identifier">amap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ForwardAlgorithm.html#alphas%27"><span class="hs-identifier hs-var">alphas'</span></a><span> </span><span class="hs-special">(</span><a href="ForwardAlgorithm.html#alpha_t"><span class="hs-identifier hs-var">alpha_t</span></a><span> </span><a href="#local-6989586621679046275"><span class="hs-identifier hs-var">amap</span></a><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- | The alphas for observation o_1 given a model</span><span>
</span><a name="line-48"></a><span class="hs-identifier">alphas_1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679046249"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679046250"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679046251"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HMM.html#HMM"><span class="hs-identifier hs-type">HMM</span></a><span> </span><a href="#local-6989586621679046250"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046252"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679046249"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679046251"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046252"><span class="hs-identifier hs-type">o</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ForwardAlgorithm.html#AlphaMap"><span class="hs-identifier hs-type">AlphaMap</span></a><span> </span><a href="#local-6989586621679046250"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046249"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-50"></a><a name="alphas_1"><a href="ForwardAlgorithm.html#alphas_1"><span class="hs-identifier">alphas_1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ForwardAlgorithm.html#alphas%27"><span class="hs-identifier hs-var">alphas'</span></a><span> </span><span class="hs-special">(</span><a href="ForwardAlgorithm.html#alpha1"><span class="hs-identifier hs-var">alpha1</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">-- | the abstract calculation for the alphas of an observation o with respect</span><span>
</span><a name="line-53"></a><span class="hs-comment">-- to a model and observation. The first argument is a function that calculates</span><span>
</span><a name="line-54"></a><span class="hs-comment">-- the alpha value for a given state s_i given its StateInfo view and the observation. \\</span><span>
</span><a name="line-55"></a><span class="hs-comment">-- This is used to provide an abstraction so that addition data can be curried into the</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- function before alpha's is called.</span><span>
</span><a name="line-57"></a><span class="hs-identifier">alphas'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679046245"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679046246"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679046247"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="HMM.html#StateInfo"><span class="hs-identifier hs-type">StateInfo</span></a><span> </span><a href="#local-6989586621679046246"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046248"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679046245"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046248"><span class="hs-identifier hs-type">o</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ForwardAlgorithm.html#Alpha"><span class="hs-identifier hs-type">Alpha</span></a><span> </span><a href="#local-6989586621679046245"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HMM.html#HMM"><span class="hs-identifier hs-type">HMM</span></a><span> </span><a href="#local-6989586621679046246"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046248"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679046245"><span class="hs-identifier hs-type">p</span></a><span> </span><a href="#local-6989586621679046247"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046248"><span class="hs-identifier hs-type">o</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ForwardAlgorithm.html#AlphaMap"><span class="hs-identifier hs-type">AlphaMap</span></a><span> </span><a href="#local-6989586621679046246"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046245"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-59"></a><a name="alphas%27"><a href="ForwardAlgorithm.html#alphas%27"><span class="hs-identifier">alphas'</span></a></a><span> </span><a name="local-6989586621679046276"><a href="#local-6989586621679046276"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679046277"><a href="#local-6989586621679046277"><span class="hs-identifier">hmm</span></a></a><span> </span><a name="local-6989586621679046278"><a href="#local-6989586621679046278"><span class="hs-identifier">obs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HMM.html#overStateSpace"><span class="hs-identifier hs-var">overStateSpace</span></a><span> </span><a href="#local-6989586621679046277"><span class="hs-identifier hs-var">hmm</span></a><span> </span><a href="#local-6989586621679046279"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-60"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679046279"><a href="#local-6989586621679046279"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679046280"><a href="#local-6989586621679046280"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679046276"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="HMM.html#stateInfo"><span class="hs-identifier hs-var">stateInfo</span></a><span> </span><a href="#local-6989586621679046277"><span class="hs-identifier hs-var">hmm</span></a><span> </span><a href="#local-6989586621679046280"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046278"><span class="hs-identifier hs-var">obs</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | the calculation of a forward variable with respect to the first observation in a sequence</span><span>
</span><a name="line-63"></a><span class="hs-identifier">alpha1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679046242"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HMM.html#StateInfo"><span class="hs-identifier hs-type">StateInfo</span></a><span> </span><a href="#local-6989586621679046243"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046244"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679046242"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046244"><span class="hs-identifier hs-type">o</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ForwardAlgorithm.html#Alpha"><span class="hs-identifier hs-type">Alpha</span></a><span> </span><a href="#local-6989586621679046242"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-65"></a><a name="alpha1"><a href="ForwardAlgorithm.html#alpha1"><span class="hs-identifier">alpha1</span></a></a><span> </span><a name="local-6989586621679046281"><a href="#local-6989586621679046281"><span class="hs-identifier">st_info</span></a></a><span> </span><a name="local-6989586621679046282"><a href="#local-6989586621679046282"><span class="hs-identifier">obs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679046284"><span class="hs-identifier hs-var">pi</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679046283"><span class="hs-identifier hs-var">b_i</span></a><span>
</span><a name="line-66"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679046283"><a href="#local-6989586621679046283"><span class="hs-identifier">b_i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">p_obs</span><span> </span><a href="#local-6989586621679046281"><span class="hs-identifier hs-var">st_info</span></a><span> </span><a href="#local-6989586621679046282"><span class="hs-identifier hs-var">obs</span></a><span>
</span><a name="line-67"></a><span>        </span><a name="local-6989586621679046284"><a href="#local-6989586621679046284"><span class="hs-identifier">pi</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pi_s</span><span> </span><a href="#local-6989586621679046281"><span class="hs-identifier hs-var">st_info</span></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">-- | the calculation for a forward variable for any (non-initial) observation with respect to</span><span>
</span><a name="line-70"></a><span class="hs-comment">-- the previous observation's forward variables, the current state's(s_j) state info</span><span>
</span><a name="line-71"></a><span class="hs-identifier">alpha_t</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679046239"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="ForwardAlgorithm.html#AlphaMap"><span class="hs-identifier hs-type">AlphaMap</span></a><span> </span><a href="#local-6989586621679046240"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046239"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HMM.html#StateInfo"><span class="hs-identifier hs-type">StateInfo</span></a><span> </span><a href="#local-6989586621679046240"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046241"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679046239"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046241"><span class="hs-identifier hs-type">o</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ForwardAlgorithm.html#Alpha"><span class="hs-identifier hs-type">Alpha</span></a><span> </span><a href="#local-6989586621679046239"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-72"></a><a name="alpha_t"><a href="ForwardAlgorithm.html#alpha_t"><span class="hs-identifier">alpha_t</span></a></a><span> </span><a name="local-6989586621679046285"><a href="#local-6989586621679046285"><span class="hs-identifier">a_map</span></a></a><span> </span><a name="local-6989586621679046286"><a href="#local-6989586621679046286"><span class="hs-identifier">stinfo_j</span></a></a><span> </span><a name="local-6989586621679046287"><a href="#local-6989586621679046287"><span class="hs-identifier">obs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679046289"><span class="hs-identifier hs-var">p_into</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679046288"><span class="hs-identifier hs-var">b_j</span></a><span>
</span><a name="line-73"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679046288"><a href="#local-6989586621679046288"><span class="hs-identifier">b_j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">p_obs</span><span> </span><a href="#local-6989586621679046286"><span class="hs-identifier hs-var">stinfo_j</span></a><span> </span><a href="#local-6989586621679046287"><span class="hs-identifier hs-var">obs</span></a><span>
</span><a name="line-74"></a><span>        </span><a name="local-6989586621679046289"><a href="#local-6989586621679046289"><span class="hs-identifier">p_into</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ForwardAlgorithm.html#pInto"><span class="hs-identifier hs-var">pInto</span></a><span> </span><a href="#local-6989586621679046286"><span class="hs-identifier hs-var">stinfo_j</span></a><span> </span><a href="#local-6989586621679046285"><span class="hs-identifier hs-var">a_map</span></a><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">-- | The probability of transitioning into state s_j from all other states given the forward</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- variable from the previous observation</span><span>
</span><a name="line-78"></a><span class="hs-identifier">pInto</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679046236"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HMM.html#StateInfo"><span class="hs-identifier hs-type">StateInfo</span></a><span> </span><a href="#local-6989586621679046237"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046238"><span class="hs-identifier hs-type">o</span></a><span> </span><a href="#local-6989586621679046236"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ForwardAlgorithm.html#AlphaMap"><span class="hs-identifier hs-type">AlphaMap</span></a><span> </span><a href="#local-6989586621679046237"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679046236"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046236"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-79"></a><a name="pInto"><a href="ForwardAlgorithm.html#pInto"><span class="hs-identifier">pInto</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HMM.html#pIntoG"><span class="hs-identifier hs-var">pIntoG</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a></pre></body></html>