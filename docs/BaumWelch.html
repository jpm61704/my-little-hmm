<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>BaumWelch</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/BaumWelch.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">my-little-hmm-0.1.0.0</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">BaumWelch</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Estimation Step</a></li><li><a href="#g:2">Maximization Step</a></li><li><a href="#g:3">Bringing it All Together</a></li><li><a href="#g:4">Time-Tagged Data</a></li></ul></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:monitoredTraining">monitoredTraining</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> s, <a href="../base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> o, <a href="../base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> o) =&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="../base-4.11.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t)</li><li class="src short"><span class="keyword">type</span> <a href="#t:EstimationStep">EstimationStep</a> s o p t m = <a href="../mtl-2.2.2/Control-Monad-Reader.html#t:ReaderT" title="Control.Monad.Reader">ReaderT</a> (<a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p), <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t, p) m</li><li class="src short"><a href="#v:getsTM">getsTM</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (<a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p) -&gt; a) -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m a</li><li class="src short"><a href="#v:getsTD">getsTD</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p -&gt; a) -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m a</li><li class="src short"><a href="#v:getAlpha">getAlpha</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m (<a href="ForwardAlgorithm.html#t:Alpha" title="ForwardAlgorithm">Alpha</a> p)</li><li class="src short"><a href="#v:getBeta">getBeta</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m (<a href="BackwardAlgorithm.html#t:Beta" title="BackwardAlgorithm">Beta</a> p)</li><li class="src short"><a href="#v:getObs">getObs</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m o</li><li class="src short"><a href="#v:getsHMM">getsHMM</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (<a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; a) -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m a</li><li class="src short"><a href="#v:getA_ij">getA_ij</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; s -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m p</li><li class="src short"><a href="#v:getB_j">getB_j</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m (o -&gt; p)</li><li class="src short"><a href="#v:getLikelihood">getLikelihood</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m p</li><li class="src short"><a href="#v:calcXi">calcXi</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; s -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m p</li><li class="src short"><a href="#v:calcGamma-39-">calcGamma'</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Foldable.html#t:Foldable" title="Data.Foldable">Foldable</a> t, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m p</li><li class="src short"><a href="#v:calcGamma">calcGamma</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Foldable.html#t:Foldable" title="Data.Foldable">Foldable</a> t, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m p</li><li class="src short"><a href="#v:estData_t">estData_t</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m (<a href="BaumWelch.html#t:EstimationData" title="BaumWelch">EstimationData</a> s o p)</li><li class="src short"><a href="#v:estData">estData</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p) =&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m (<a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:EstimationData" title="BaumWelch">EstimationData</a> s o p))</li><li class="src short"><span class="keyword">type</span> <a href="#t:MaximizationStep">MaximizationStep</a> s o p t = <a href="../mtl-2.2.2/Control-Monad-Reader.html#t:ReaderT" title="Control.Monad.Reader">ReaderT</a> (<a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:EstimationData" title="BaumWelch">EstimationData</a> s o p), <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t)</li><li class="src short"><a href="#v:getGamma">getGamma</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s p)</li><li class="src short"><a href="#v:getXi">getXi</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s p))</li><li class="src short"><a href="#v:getObsActualAt">getObsActualAt</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, o)</li><li class="src short"><a href="#v:getsHMM_M">getsHMM_M</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (<a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; a) -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m a</li><li class="src short"><a href="#v:pi-39-">pi'</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (s -&gt; p)</li><li class="src short"><a href="#v:foreachStateTransition">foreachStateTransition</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; (s -&gt; s -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m a) -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s a))</li><li class="src short"><a href="#v:foreachStateAndObs">foreachStateAndObs</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> o) =&gt; (s -&gt; o -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m a) -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> o a))</li><li class="src short"><a href="#v:mapToTwoArgFunc">mapToTwoArgFunc</a> :: (<a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> k1, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> k2) =&gt; <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> k1 (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> k2 v) -&gt; k1 -&gt; k2 -&gt; v</li><li class="src short"><a href="#v:alpha-39-">alpha'</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (s -&gt; s -&gt; p)</li><li class="src short"><a href="#v:beta-39-">beta'</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> o, <a href="../base-4.11.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> o) =&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (s -&gt; o -&gt; p)</li><li class="src short"><a href="#v:normalizeDist">normalizeDist</a> :: (<a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> k) =&gt; <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> k p -&gt; <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> k p</li><li class="src short"><a href="#v:maximization">maximization</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> o, <a href="../base-4.11.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> o) =&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t)</li><li class="src short"><a href="#v:mapToFunc">mapToFunc</a> :: <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> k =&gt; <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> k a -&gt; k -&gt; a</li><li class="src short"><a href="#v:reestimate">reestimate</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> o, <a href="../base-4.11.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> o) =&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t</li><li class="src short"><a href="#v:initData">initData</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; (<a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p), <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t, p)</li><li class="src short"><a href="#v:initialTimeData">initialTimeData</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p)</li><li class="src short"><a href="#v:computeAlphas">computeAlphas</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="ForwardAlgorithm.html#t:AlphaMap" title="ForwardAlgorithm">AlphaMap</a> s p)</li><li class="src short"><a href="#v:computeBetas">computeBetas</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BackwardAlgorithm.html#t:BetaMap" title="BackwardAlgorithm">BetaMap</a> s p)</li><li class="src short"><a href="#v:computeLikelihood">computeLikelihood</a> :: <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p =&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p) -&gt; p</li><li class="src short"><span class="keyword">type</span> <a href="#t:Time">Time</a> = <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:TimeMap">TimeMap</a> a = <a href="../containers-0.5.11.0/Data-IntMap-Strict.html#t:IntMap" title="Data.IntMap.Strict">IntMap</a> a</li><li class="src short"><span class="keyword">data</span> <a href="#t:TimeData">TimeData</a> s o p = <a href="#v:TimeData">TimeData</a> {<ul class="subs"><li><a href="#v:alpha">alpha</a> :: <a href="ForwardAlgorithm.html#t:AlphaMap" title="ForwardAlgorithm">AlphaMap</a> s p</li><li><a href="#v:beta">beta</a> :: <a href="BackwardAlgorithm.html#t:BetaMap" title="BackwardAlgorithm">BetaMap</a> s p</li><li><a href="#v:t_obs">t_obs</a> :: o</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:EstimationData">EstimationData</a> s o p = <a href="#v:EstData">EstData</a> {<ul class="subs"><li><a href="#v:gamma">gamma</a> :: <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s p</li><li><a href="#v:xi">xi</a> :: <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s p)</li><li><a href="#v:e_obs">e_obs</a> :: o</li></ul>}</li><li class="src short"><a href="#v:mkTimeData">mkTimeData</a> :: <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="ForwardAlgorithm.html#t:AlphaMap" title="ForwardAlgorithm">AlphaMap</a> s p) -&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BackwardAlgorithm.html#t:BetaMap" title="BackwardAlgorithm">BetaMap</a> s p) -&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p)</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:monitoredTraining" class="def">monitoredTraining</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> s, <a href="../base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> o, <a href="../base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> o) =&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="../base-4.11.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t) <a href="src/BaumWelch.html#monitoredTraining" class="link">Source</a> <a href="#v:monitoredTraining" class="selflink">#</a></p></div><a href="#g:1" id="g:1"><h1>Estimation Step</h1></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:EstimationStep" class="def">EstimationStep</a> s o p t m = <a href="../mtl-2.2.2/Control-Monad-Reader.html#t:ReaderT" title="Control.Monad.Reader">ReaderT</a> (<a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p), <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t, p) m <a href="src/BaumWelch.html#EstimationStep" class="link">Source</a> <a href="#t:EstimationStep" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getsTM" class="def">getsTM</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (<a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p) -&gt; a) -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m a <a href="src/BaumWelch.html#getsTM" class="link">Source</a> <a href="#v:getsTM" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getsTD" class="def">getsTD</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p -&gt; a) -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m a <a href="src/BaumWelch.html#getsTD" class="link">Source</a> <a href="#v:getsTD" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getAlpha" class="def">getAlpha</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m (<a href="ForwardAlgorithm.html#t:Alpha" title="ForwardAlgorithm">Alpha</a> p) <a href="src/BaumWelch.html#getAlpha" class="link">Source</a> <a href="#v:getAlpha" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getBeta" class="def">getBeta</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m (<a href="BackwardAlgorithm.html#t:Beta" title="BackwardAlgorithm">Beta</a> p) <a href="src/BaumWelch.html#getBeta" class="link">Source</a> <a href="#v:getBeta" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getObs" class="def">getObs</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m o <a href="src/BaumWelch.html#getObs" class="link">Source</a> <a href="#v:getObs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getsHMM" class="def">getsHMM</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (<a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; a) -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m a <a href="src/BaumWelch.html#getsHMM" class="link">Source</a> <a href="#v:getsHMM" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getA_ij" class="def">getA_ij</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; s -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m p <a href="src/BaumWelch.html#getA_ij" class="link">Source</a> <a href="#v:getA_ij" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getB_j" class="def">getB_j</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m (o -&gt; p) <a href="src/BaumWelch.html#getB_j" class="link">Source</a> <a href="#v:getB_j" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getLikelihood" class="def">getLikelihood</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m p <a href="src/BaumWelch.html#getLikelihood" class="link">Source</a> <a href="#v:getLikelihood" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:calcXi" class="def">calcXi</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; s -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m p <a href="src/BaumWelch.html#calcXi" class="link">Source</a> <a href="#v:calcXi" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:calcGamma-39-" class="def">calcGamma'</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Foldable.html#t:Foldable" title="Data.Foldable">Foldable</a> t, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m p <a href="src/BaumWelch.html#calcGamma%27" class="link">Source</a> <a href="#v:calcGamma-39-" class="selflink">#</a></p><div class="doc"><p>Note: Source of inefficiency because this recalculations all Xi a bunch of times</p></div></div><div class="top"><p class="src"><a id="v:calcGamma" class="def">calcGamma</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Foldable.html#t:Foldable" title="Data.Foldable">Foldable</a> t, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; s -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m p <a href="src/BaumWelch.html#calcGamma" class="link">Source</a> <a href="#v:calcGamma" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:estData_t" class="def">estData_t</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p) =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m (<a href="BaumWelch.html#t:EstimationData" title="BaumWelch">EstimationData</a> s o p) <a href="src/BaumWelch.html#estData_t" class="link">Source</a> <a href="#v:estData_t" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:estData" class="def">estData</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p) =&gt; <a href="BaumWelch.html#t:EstimationStep" title="BaumWelch">EstimationStep</a> s o p t m (<a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:EstimationData" title="BaumWelch">EstimationData</a> s o p)) <a href="src/BaumWelch.html#estData" class="link">Source</a> <a href="#v:estData" class="selflink">#</a></p></div><a href="#g:2" id="g:2"><h1>Maximization Step</h1></a><div class="doc"><p>We can reuse the estimation monad stack for this section</p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:MaximizationStep" class="def">MaximizationStep</a> s o p t = <a href="../mtl-2.2.2/Control-Monad-Reader.html#t:ReaderT" title="Control.Monad.Reader">ReaderT</a> (<a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:EstimationData" title="BaumWelch">EstimationData</a> s o p), <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t) <a href="src/BaumWelch.html#MaximizationStep" class="link">Source</a> <a href="#t:MaximizationStep" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getGamma" class="def">getGamma</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s p) <a href="src/BaumWelch.html#getGamma" class="link">Source</a> <a href="#v:getGamma" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getXi" class="def">getXi</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s p)) <a href="src/BaumWelch.html#getXi" class="link">Source</a> <a href="#v:getXi" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getObsActualAt" class="def">getObsActualAt</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a>, o) <a href="src/BaumWelch.html#getObsActualAt" class="link">Source</a> <a href="#v:getObsActualAt" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getsHMM_M" class="def">getsHMM_M</a> :: <a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (<a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; a) -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m a <a href="src/BaumWelch.html#getsHMM_M" class="link">Source</a> <a href="#v:getsHMM_M" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pi-39-" class="def">pi'</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (s -&gt; p) <a href="src/BaumWelch.html#pi%27" class="link">Source</a> <a href="#v:pi-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:foreachStateTransition" class="def">foreachStateTransition</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; (s -&gt; s -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m a) -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s a)) <a href="src/BaumWelch.html#foreachStateTransition" class="link">Source</a> <a href="#v:foreachStateTransition" class="selflink">#</a></p><div class="doc"><p>complete some monadic action for each state transition</p></div></div><div class="top"><p class="src"><a id="v:foreachStateAndObs" class="def">foreachStateAndObs</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> o) =&gt; (s -&gt; o -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m a) -&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> o a)) <a href="src/BaumWelch.html#foreachStateAndObs" class="link">Source</a> <a href="#v:foreachStateAndObs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mapToTwoArgFunc" class="def">mapToTwoArgFunc</a> :: (<a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> k1, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> k2) =&gt; <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> k1 (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> k2 v) -&gt; k1 -&gt; k2 -&gt; v <a href="src/BaumWelch.html#mapToTwoArgFunc" class="link">Source</a> <a href="#v:mapToTwoArgFunc" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:alpha-39-" class="def">alpha'</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (s -&gt; s -&gt; p) <a href="src/BaumWelch.html#alpha%27" class="link">Source</a> <a href="#v:alpha-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:beta-39-" class="def">beta'</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> o, <a href="../base-4.11.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> o) =&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (s -&gt; o -&gt; p) <a href="src/BaumWelch.html#beta%27" class="link">Source</a> <a href="#v:beta-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:normalizeDist" class="def">normalizeDist</a> :: (<a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> k) =&gt; <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> k p -&gt; <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> k p <a href="src/BaumWelch.html#normalizeDist" class="link">Source</a> <a href="#v:normalizeDist" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:maximization" class="def">maximization</a> :: (<a href="../base-4.11.1.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m, <a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> o, <a href="../base-4.11.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> o) =&gt; <a href="BaumWelch.html#t:MaximizationStep" title="BaumWelch">MaximizationStep</a> s o p t m (<a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t) <a href="src/BaumWelch.html#maximization" class="link">Source</a> <a href="#v:maximization" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mapToFunc" class="def">mapToFunc</a> :: <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> k =&gt; <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> k a -&gt; k -&gt; a <a href="src/BaumWelch.html#mapToFunc" class="link">Source</a> <a href="#v:mapToFunc" class="selflink">#</a></p></div><a href="#g:3" id="g:3"><h1>Bringing it All Together</h1></a><div class="top"><p class="src"><a id="v:reestimate" class="def">reestimate</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Prelude.html#t:Fractional" title="Prelude">Fractional</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> o, <a href="../base-4.11.1.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> o) =&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t <a href="src/BaumWelch.html#reestimate" class="link">Source</a> <a href="#v:reestimate" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:initData" class="def">initData</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; (<a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p), <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t, p) <a href="src/BaumWelch.html#initData" class="link">Source</a> <a href="#v:initData" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:initialTimeData" class="def">initialTimeData</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p) <a href="src/BaumWelch.html#initialTimeData" class="link">Source</a> <a href="#v:initialTimeData" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:computeAlphas" class="def">computeAlphas</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="ForwardAlgorithm.html#t:AlphaMap" title="ForwardAlgorithm">AlphaMap</a> s p) <a href="src/BaumWelch.html#computeAlphas" class="link">Source</a> <a href="#v:computeAlphas" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:computeBetas" class="def">computeBetas</a> :: (<a href="../base-4.11.1.0/Data-Traversable.html#t:Traversable" title="Data.Traversable">Traversable</a> t, <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p, <a href="../base-4.11.1.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> s) =&gt; <a href="HMM.html#t:HMM" title="HMM">HMM</a> s o p t -&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BackwardAlgorithm.html#t:BetaMap" title="BackwardAlgorithm">BetaMap</a> s p) <a href="src/BaumWelch.html#computeBetas" class="link">Source</a> <a href="#v:computeBetas" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:computeLikelihood" class="def">computeLikelihood</a> :: <a href="../base-4.11.1.0/Prelude.html#t:Num" title="Prelude">Num</a> p =&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p) -&gt; p <a href="src/BaumWelch.html#computeLikelihood" class="link">Source</a> <a href="#v:computeLikelihood" class="selflink">#</a></p></div><a href="#g:4" id="g:4"><h1>Time-Tagged Data</h1></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Time" class="def">Time</a> = <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/BaumWelch.html#Time" class="link">Source</a> <a href="#t:Time" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TimeMap" class="def">TimeMap</a> a = <a href="../containers-0.5.11.0/Data-IntMap-Strict.html#t:IntMap" title="Data.IntMap.Strict">IntMap</a> a <a href="src/BaumWelch.html#TimeMap" class="link">Source</a> <a href="#t:TimeMap" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TimeData" class="def">TimeData</a> s o p <a href="src/BaumWelch.html#TimeData" class="link">Source</a> <a href="#t:TimeData" class="selflink">#</a></p><div class="doc"><p>Time ordered forward/backward variables with their respective observations</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TimeData" class="def">TimeData</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:alpha" class="def">alpha</a> :: <a href="ForwardAlgorithm.html#t:AlphaMap" title="ForwardAlgorithm">AlphaMap</a> s p</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:beta" class="def">beta</a> :: <a href="BackwardAlgorithm.html#t:BetaMap" title="BackwardAlgorithm">BetaMap</a> s p</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:t_obs" class="def">t_obs</a> :: o</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><details id="i:TimeData" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TimeData:Show:1"></span> (<a href="../base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> s, <a href="../base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> p, <a href="../base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> o) =&gt; <a href="../base-4.11.1.0/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p)</span> <a href="src/BaumWelch.html#line-274" class="link">Source</a> <a href="#t:TimeData" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TimeData:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="BaumWelch.html">BaumWelch</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.11.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p -&gt; <a href="../base-4.11.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p -&gt; <a href="../base-4.11.1.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p] -&gt; <a href="../base-4.11.1.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:EstimationData" class="def">EstimationData</a> s o p <a href="src/BaumWelch.html#EstimationData" class="link">Source</a> <a href="#t:EstimationData" class="selflink">#</a></p><div class="doc"><p>Time ordered estimation-step data</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:EstData" class="def">EstData</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:gamma" class="def">gamma</a> :: <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s p</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:xi" class="def">xi</a> :: <a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s (<a href="../containers-0.5.11.0/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> s p)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:e_obs" class="def">e_obs</a> :: o</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a id="v:mkTimeData" class="def">mkTimeData</a> :: <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="ForwardAlgorithm.html#t:AlphaMap" title="ForwardAlgorithm">AlphaMap</a> s p) -&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BackwardAlgorithm.html#t:BetaMap" title="BackwardAlgorithm">BetaMap</a> s p) -&gt; <a href="HMM.html#t:ObservationSeq" title="HMM">ObservationSeq</a> o -&gt; <a href="BaumWelch.html#t:TimeMap" title="BaumWelch">TimeMap</a> (<a href="BaumWelch.html#t:TimeData" title="BaumWelch">TimeData</a> s o p) <a href="src/BaumWelch.html#mkTimeData" class="link">Source</a> <a href="#v:mkTimeData" class="selflink">#</a></p><div class="doc"><p>aggregation of TimeMaps AlphaMap and BetaMap with their observation sequence</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.20.0</p></div></body></html>